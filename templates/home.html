{% extends "base.html" %}

{% block title %}لوحة المعلومات - نظام إدارة المشتريات{% endblock %}

{% block content %}
<div class="page-header fade-up">
    <div class="page-header-content">
        <div>
            <h1 class="page-title">لوحة المعلومات</h1>
            <p class="page-subtitle">مرحباً بك في نظام إدارة المشتريات</p>
        </div>
    </div>
</div>

<div class="glass-card fade-up">
    <h2 style="color: #10b981; margin-bottom: 20px;">✅ النظام يعمل بنجاح!</h2>
    <p style="margin-bottom: 15px;">تم الاتصال بخادم Railway بنجاح.</p>
    
    <div style="background: rgba(16, 185, 129, 0.1); padding: 20px; border-radius: 12px; border: 1px solid rgba(16, 185, 129, 0.3);">
        <h3 style="margin-bottom: 15px;">معلومات النظام:</h3>
        <ul style="list-style: none; padding: 0;">
            <li style="margin-bottom: 10px;">📍 الحالة: <span style="color: #10b981;">نشط</span></li>
            <li style="margin-bottom: 10px;">🔗 قاعدة البيانات: <span id="db-status">جاري التحقق...</span></li>
            <li style="margin-bottom: 10px;">📊 الإصدار: 1.0.0</li>
        </ul>
    </div>
    
    <div style="margin-top: 30px;">
        <button onclick="testDatabase()" class="btn btn-info">اختبار قاعدة البيانات</button>
        <button onclick="checkEnvironment()" class="btn btn-warning" style="margin-right: 10px;">فحص المتغيرات</button>
    </div>
</div>

<script>
// اختبار قاعدة البيانات
async function testDatabase() {
    try {
        const response = await fetch('/test-db');
        const data = await response.json();
        
        const statusEl = document.getElementById('db-status');
        if (data.status === 'success') {
            statusEl.innerHTML = '<span style="color: #10b981;">متصل</span>';
            alert('✅ ' + data.message);
        } else {
            statusEl.innerHTML = '<span style="color: #ef4444;">غير متصل</span>';
            alert('❌ ' + data.message);
        }
    } catch (error) {
        alert('خطأ في الاختبار: ' + error.message);
    }
}

// فحص متغيرات البيئة
async function checkEnvironment() {
    try {
        const response = await fetch('/check-env');
        const data = await response.json();
        
        let message = 'حالة المتغيرات:\n\n';
        for (const [key, value] of Object.entries(data)) {
            message += `${key}: ${value}\n`;
        }
        
        alert(message);
    } catch (error) {
        alert('خطأ في الفحص: ' + error.message);
    }
}

// اختبار تلقائي عند التحميل
window.onload = function() {
    testDatabase();
}
</script>
{% endblock %}
